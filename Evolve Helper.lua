local function AAAAAAAAAAA()
    ::A1111111111::
    ::A2222222222::
    ::A3333333333::
    goto A1111111111
    goto A2222222222
    goto A3333333333
end

local function ADC2()
    goto D366666
    ::D366666::
    (""):__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()
    (""):__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()
    (""):__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()
    (""):__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()
    (""):__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()
    (""):__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()
    (""):__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()
    (""):__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()
    (""):__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()
    (""):__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()
    (""):__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()
    (""):__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()():__()
    goto D366666
    ::A11111111112::
    ::A22222222222::
    ::A33333333332::
    goto A11111111112
    goto A22222222222
    goto A33333333332
end

script_name("Evolve Helper")
script_author("petya.sushkin")

require "lib.moonloader"
local imgui = require("mimgui")
local hotkey = require("mimgui_hotkeys")
local vkeys = require("vkeys")
local ffi = require("ffi")
local faicons = require("fAwesome6")
local sampapi = require("sampapi")
local wm = require("windows.message")
local ev = require "lib.samp.events"
local encoding = require("encoding")
u8, encoding.default = encoding.UTF8, "CP1251"
local sampfuncs = require 'sampfuncs'
local raknet = require 'samp.raknet'

local inicfg = require("inicfg")
local IniFilename = "evhelpconfig.ini"
local ini = inicfg.load({
	main = {
		openmenucommand = "evhelp",
		materials = "400",
		drugs = "400"
	},
	funcs = {
		usnarko = false,
		takematerials = false,
		takematerialsdnk = false,
		takedrugsdnk = false,
		bind = "[18,50]",
		binddrug = "[18, 49]",
		azaon = false,
		azakolvo = "10",
		azaskolko = "10", 
		checkonlinecommand = "co",
		autodeagle = false,
		autodeaglept = "10",
		antiafk = false,
		capturecmd = "ccapt"
	},
	help = {
		narkopriton = false,
		launcher = false,
		dnkvixod = false,
		paintball = false,
		racing = false,
		base = false,
		drift = false,
		derby = false,
		mpvalue = "2000",
		dnkradar = false,
		dnkradaricon = "55",
		adminscmd = "aadmins"
	}
}, IniFilename)


---[LOCAL]
local usnarko = imgui.new.bool(ini.funcs.usnarko)
local takematerials = imgui.new.bool(ini.funcs.takematerials)
local takematerialsdnk = imgui.new.bool(ini.funcs.takematerialsdnk)
local takedrugsdnk = imgui.new.bool(ini.funcs.takedrugsdnk)
local azaon = imgui.new.bool(ini.funcs.azaon)
local mainWindow = imgui.new.bool(true)
local dnkradaricon = ini.help.dnkradaricon
local dnkradar = imgui.new.bool(ini.help.dnkradar)
local openmenu = imgui.new.char[128](ini.main.openmenucommand)
local checkonline = imgui.new.char[128](ini.funcs.checkonlinecommand)
local adminscmd = imgui.new.char[128](ini.help.adminscmd)
local capturecmd = imgui.new.char[16](ini.funcs.capturecmd)
local inputiddnk = imgui.new.char[16]()
local azakolvo = tonumber(ini.funcs.azakolvo) or 0
local azaskolko = tonumber(ini.funcs.azaskolko) or 0 
local autodeaglept = tonumber(ini.funcs.autodeaglept) or 0
local autodeagle = imgui.new.bool(ini.funcs.autodeagle)
local narkopriton = imgui.new.bool(ini.help.narkopriton)
local launcher = imgui.new.bool(ini.help.launcher)
local dnkvixod = imgui.new.bool(ini.help.dnkvixod)
local drift = imgui.new.bool(ini.help.drift)
local derby = imgui.new.bool(ini.help.derby)
local base = imgui.new.bool(ini.help.base)
local paintball = imgui.new.bool(ini.help.paintball)
local racing = imgui.new.bool(ini.help.racing)
local antiafk = imgui.new.bool(ini.funcs.antiafk)
local sliderkolvo = imgui.new.int(azakolvo)
local sliderskolko = imgui.new.int(azaskolko)
local deaglept = imgui.new.int(autodeaglept)
local valuemp = tonumber(ini.help.mpvalue) or 0
local valuempmp = imgui.new.int(valuemp)
local azazlo = false
local dnkHotKey
local drugHotKey
local selectdialogfcr = false
local closeNextDialog = false
local floodActive = false
local flooddelay = 0
local clists = {
    -- Evolve RP
    {
        0xAA009F00, -- grove.
        0xFFB313E7, -- ballas.
        0xFFFFDE24, -- vagos.
        0xFF2A9170, -- rifa.
        0xC801FCFF, -- aztec.
        4281545523, -- mongols mc
        4294201344, -- warlocks mc
        4281110935, -- pagans mc
        0xFFDDA701, -- lcn.
        0xAAFF0000, -- yakuza.
        0xFFb4b5b7, -- russian mafia.
    }
}
local texts = {
    -- evolve rp
    '- {0ec78f}GANGS: {FFFFFF}G: {$CLR}$CNT {FFFFFF}| B: {$CLR}$CNT {FFFFFF}| V: {$CLR}$CNT {FFFFFF}| R: {$CLR}$CNT {FFFFFF}| A: {$CLR}$CNT \n- {0ec78f}BIKERS: {FFFFFF}MG: {$CLR}$CNT {FFFFFF}| WA: {$CLR}$CNT {FFFFFF}| PA: {$CLR}$CNT\n- {0ec78f}MAFIA: {FFFFFF}LCN: {$CLR}$CNT {FFFFFF}| YZ: {$CLR}$CNT {FFFFFF}| RM: {$CLR}$CNT'
}
local AddedBlips = {}
local AddLogs = {}
local admins_server1 = {
    {"Aleksey_Efimenko", 7}, {"Michael_Rojas", 6}, {"Fernando_Bennet", 6},
    {"Morphius_Mulphers", 5}, {"Wilion_Walker", 5}, {"Egor_Ufimtsev", 5},
    {"Anthony_Cerezo", 5}, {"Emma_Cooper", 5}, {"Laurance_Rockefeller", 5},
    {"Sky_Whitish", 5}, {"Niko_Filliams", 5}, {"Christopher_Morrar", 5},
    {"Jayden_Henderson", 5}, {"Aaron_Arthate", 5}, {"Cody_Flatcher", 5},
    {"Kenji_Uchida", 5}, {"Edward_Needes", 5}, {"Aleksei_Kuznetcov", 5},
    {"Diego_Aminatore", 5}, {"Marco_Mazzini", 5}, {"Jenifer_Henderson", 5},
    {"Jennifer_Ruthless", 5}, {"Hatezz_Squeeze", 5}, {"Godfazer_Dungfer", 5},
    {"Carlo_Barbero", 5}, {"Flash_Fawkexz", 5}, {"Joe_Armstrong", 5},
    {"Jesusique_Brights", 5}, {"Ruslan_Satriano", 5}, {"Noel_Dorsey", 5},
    {"Alejandro_Ferraro", 5}, {"Ruslan_Melnychenko", 4}, {"Duzya_DeCastillo", 4},
    {"Phoenix_Wright", 4}, {"Mayu_Sakura", 4}, {"Laurent_Lemieux", 4},
    {"Desmond_Mitchell", 4}, {"Maksonchik_Mora", 4}, {"Midzuki_Cerezo", 3},
    {"Jason_Pringlez", 3}, {"Sketch_Phasewalker", 3}, {"Weaknessx_Sotobozz", 2},
    {"Flora_Midnightz", 2}, {"Emily_Raylonds", 2}, {"Chris_Ludvig", 2},
    {"Ilyushka_Asad", 2}, {"Thomas_Schwarzz", 2}, {"Emmett_Hoggarth", 2}
}
local admins_server2 = {
    {"Perfecto_Rodriguez", 7}, {"Daniel_Salaru", 6}, {"Dmitriy_Kayzer", 6},
    {"Mario_Fawa", 6}, {"Michael_Rojas", 6}, {"Zhenya_Marchev", 4},
    {"Kimberly_Norton", 5}, {"Sasori_Qween", 5}, {"Tony_Newton", 5},
    {"Tema_Melnik", 5}, {"Ashley_Balenciaga", 3}, {"Dima_Mishin", 2},
	{"Esteban_Rivero", 4}, {"Jahsehz_Roshev", 2},
    {"Zigfred_Schneider", 5}, {"Dylan_Greisler", 3}, {"Max_Locor", 3},
    {"Dave_Teller", 5}, {"Carlo_Cortez", 5}, {"Pablo_Romero", 5},
    {"Wild_Staf", 5}, {"Dave_Vekko", 4}, {"Juuzou_Hakurei", 2},
    {"Andry_Lincoln", 5}, {"Alvin_Scerty", 4}, {"Henrich_Rogge", 5},
    {"Hokkaido_West", 5}, {"Yagger_Cafard", 5}, {"Lazzero_Longo", 5},
    {"Leo_Danieles", 5}, {"Jesusique_Brights", 5}, {"Ika_Soprano", 4},
    {"Morgan_West", 4}, {"Hurricane_Manning", 4}, {"Lauren_Vandom", 4},
    {"Giovanni_Lombardi", 4}, {"Razo_Almighty", 3}, {"John_Pershing", 3},
    {"Miguel_Russell", 3}, {"Gustav_Magnusson", 3}, {"Avgustique_Unhoped", 3},
    {"Roman_Chaser", 3}, {"Vinnie_Captown", 3}, {"Alexander_Fialkin", 3},
    {"Leito_Aquino", 3}, {"Johnny_Hart", 3}, {"Tsukuyomi_Powerful", 3},
    {"Devover_Dream", 3}, {"Xanje_Syntax", 2}, {"Yarche_Expluse", 2},
    {"Impressive_Plitts", 2}, {"Nikolay_Scherbina", 2}, {"Tag_King", 2},
	{"Lance_Heatley", 2}
}
local admins
local currentServerIP = "" 


----[AUTOUPDATE]
local dlstatus = require("moonloader").download_status
	update_state = false
	local script_vers = 8
	local script_vers_text = "1.4.8"

	local update_url = "https://raw.githubusercontent.com/4NC3/scripts/refs/heads/main/update.ini"
	local update_path = getWorkingDirectory() .. "update.ini"

	local script_url = "https://github.com/4NC3/scripts/raw/refs/heads/main/Evolve%20Helper.lua"
	local script_path = thisScript().path
----[AUTOUPDATE]


local mframe_t = (function()
	local this = {
		frames = {}
	}

	local metatable = {
		__index = {}
	}

	local WM_KEYDOWN = 0x0100
	local WM_KEYUP = 0x0101
	local VK_ESCAPE = 0x1B

	function metatable.__index:condition()
		return self.status and self.status[0]
	end

	function metatable.__index:draw()
		return self._draw
	end

	function metatable.__index:isActive()
		return self._render
	end

	function metatable.__index:unsubscribe()
		return self:Unsubscribe()
	end

	function metatable.__index:switch(status)
		if type(status) == "boolean" then
			self.status[0] = status
		else
			self.status[0] = not self.status[0]
		end
		return self.status[0]
	end

	function metatable:__newindex(key, value)
		if key == "draw" then
			if type(value) ~= "function" then
				return
			end
			rawset(self, "Condition", function() return self:condition() end)
			rawset(self, "_before", self.before)
			rawset(self, "_draw", value)
		else
			rawset(self, key, value)
		end
	end
	
	function this:insert(data)
		local frame = imgui.OnFrame(function() return false end, function() end)

		data.status = data.status or imgui.new.bool(false)
		data.weight = data.weight or 1

		for key, value in pairs(data) do
			if not frame[key] then
				frame[key] = value
			end
		end

		setmetatable(frame, metatable)
		table.insert(self.frames, frame)
		return frame
	end

	function this:close(status)
		local weight = -1
		for index, frame in ipairs(self.frames) do
			if frame.status[0] and frame.weight ~= 0 and frame.weight > weight then
				weight = frame.weight
			end
		end
		if weight ~= -1 and status then
			return true, 0
		end
		for index, frame in ipairs(self.frames) do
			if frame.status[0] and frame.weight == weight then
				frame.status[0] = false
			end
		end
		return weight ~= -1, 1
	end

	addEventHandler("onWindowMessage", function(message, wparameters, lparameters)
		local down = message == WM_KEYDOWN
		if down or message == WM_KEYUP then
			if wparameters == VK_ESCAPE and this:close(down) then
				consumeWindowMessage(true, false)
			end
		end
	end)

	return setmetatable(this, { __call = this.insert })
end)()

local applyCustomStyle = (function()
	local this = {
		static = {
			[imgui.Col.ChildBg]              = { 0.12, -0.50 },
			[imgui.Col.FrameBg]              = { 0.20, 0.20 },
			[imgui.Col.FrameBgHovered]       = { 0.30, 0.20 },
			[imgui.Col.FrameBgActive]        = { 0.45, 0.30 },
			[imgui.Col.WindowBg]             = { 0.00, 0.00 },
			[imgui.Col.PopupBg]              = { 0.00, 0.00 },
			[imgui.Col.Border]               = { 0.43, 0.50 },
			[imgui.Col.BorderShadow]         = { 0.00, 0.00 },
			[imgui.Col.TitleBg]              = { 0.04, 1.00 },
			[imgui.Col.TitleBgActive]        = { 0.16, 1.00 },
			[imgui.Col.TitleBgCollapsed]     = { 0.00, 0.60 },
			[imgui.Col.MenuBarBg]            = { 0.14, 1.00 },
			[imgui.Col.ScrollbarBg]          = { 0.02, 0.53 },
			[imgui.Col.ScrollbarGrab]        = { 0.31, 1.00 },
			[imgui.Col.ScrollbarGrabHovered] = { 0.41, 1.00 },
			[imgui.Col.ScrollbarGrabActive]  = { 0.51, 1.00 },
			[imgui.Col.ResizeGrip]           = { 0.13, 0.40 },
			[imgui.Col.ResizeGripHovered]    = { 0.13, 0.60 },
			[imgui.Col.ResizeGripActive]     = { 0.13, 0.80 },
			[imgui.Col.PlotLines]            = { 0.61, 1.00 },
			[imgui.Col.PlotLinesHovered]     = { 1.00, 1.00 },
			[imgui.Col.PlotHistogram]        = { 0.90, 1.00 },
			[imgui.Col.PlotHistogramHovered] = { 1.00, 1.00 },
			[imgui.Col.TextSelectedBg]       = { 0.26, 0.35 }
		},
		colored = {
			[imgui.Col.Button]           = 0.50,
			[imgui.Col.ButtonHovered]    = 0.10,
			[imgui.Col.ButtonActive]     = 0.15,
			[imgui.Col.Header]           = 0.50,
			[imgui.Col.HeaderHovered]    = 0.30,
			[imgui.Col.HeaderActive]     = 0.30,
			[imgui.Col.Separator]        = 0.00,
			[imgui.Col.SeparatorHovered] = 0.10,
			[imgui.Col.SeparatorActive]  = 0.15,
			[imgui.Col.SliderGrab]       = 0.40,
			[imgui.Col.SliderGrabActive] = 0.15,
			[imgui.Col.CheckMark]        = 0.00
		}
	}

	function this:explodeARGB(argb)
		return bit.band(bit.rshift(argb, 24), 0xFF),
			bit.band(bit.rshift(argb, 16), 0xFF),
			bit.band(bit.rshift(argb, 8), 0xFF),
			bit.band(argb, 0xFF)
	end

	function this:map(t, c)
		local r = {}
		for k, v in ipairs(t) do
			r[k] = c(v, k)
		end
		return r
	end

	function this:call(elements, infobar, text)
		local style = imgui.GetStyle()
		local colors = style.Colors

		style.WindowBorderSize       = 0.0
		style.WindowRounding         = 10.0
		style.PopupBorderSize        = 0.0
		style.PopupRounding          = 10.0
		style.ChildRounding          = 10.0
		style.WindowTitleAlign       = imgui.ImVec2(0.5, 0.5)
		style.FrameRounding          = 3.0
		style.ItemSpacing            = imgui.ImVec2(10, 5)
		style.ScrollbarSize          = 3.0
		style.ScrollbarRounding      = 0.0
		style.GrabMinSize            = 5.0
		style.GrabRounding           = 1.0
		style.WindowPadding          = imgui.ImVec2(12, 12)
		style.FramePadding           = imgui.ImVec2(5, 0)
		style.DisplayWindowPadding   = imgui.ImVec2(27, 27)
		style.DisplaySafeAreaPadding = imgui.ImVec2(5, 5)
		style.ButtonTextAlign        = imgui.ImVec2(0.5, 0.5)
		style.IndentSpacing          = 10.0
		style.Alpha                  = 1.0

		local colored = self:map({ self:explodeARGB(elements) }, function(x) return x / 255 end)
		local infobar = self:map({ self:explodeARGB(infobar) }, function(x) return x / 255 end)
		local text = self:map({ self:explodeARGB(text) }, function(x) return x / 255 end)

		for key, value in pairs(self.colored) do
			colors[key] = imgui.ImVec4(colored[2] + value, colored[3] + value, colored[4] + value, 1 - value)
		end

		for key, value in pairs(self.static) do
			colors[key] = imgui.ImVec4(
				infobar[2] + (infobar[2] >= 0.5 and -value[1] or value[1]),
				infobar[3] + (infobar[3] >= 0.5 and -value[1] or value[1]),
				infobar[4] + (infobar[4] >= 0.5 and -value[1] or value[1]),
				infobar[1] + value[2]
			)
		end

		colors[imgui.Col.Text] = imgui.ImVec4(text[2], text[3], text[4], 1)
		colors[imgui.Col.TextDisabled] = imgui.ImVec4(
			text[2] > 0.5 and text[2] - 0.3 or text[2] + 0.3,
			text[3] > 0.5 and text[3] - 0.3 or text[3] + 0.3,
			text[4] > 0.5 and text[4] - 0.3 or text[4] + 0.3,
			text[1]
		)
	end

	return setmetatable(this, { __call = this.call })
end)()

local page_t = (function()
	local this = {}

	local function constructor(_, name, icon, draw)
		return setmetatable({ name = name, icon = icon, draw = draw }, { __index = this })
	end

	return setmetatable(this, { __call = constructor })
end)()

local window = (function()
	local this = mframe_t {
		flags = imgui.WindowFlags.AlwaysAutoResize + imgui.WindowFlags.NoTitleBar + imgui.WindowFlags.NoCollapse,
	}

	local pages = {
		page_t(u8"Информация", faicons("gear"), function()
		imgui.Spacing()
		imgui.BeginChild("##openmenucommand", imgui.ImVec2(380, 60))
			imgui.SetCursorPos(imgui.ImVec2(10, 7))
			imgui.PushItemWidth(150)
			imgui.PushFont(fontSize[18])
			imgui.TextDisabled(u8"Команда для открытия меню")
			imgui.PopFont()
			imgui.SetCursorPosY(13)
			imgui.SetCursorPosX(350)
			imgui.TextDisabled(faicons("list"))
			if imgui.IsItemHovered() then
				imgui.BeginTooltip()
				imgui.TextUnformatted(u8("Открыть меню можно указанной командой (по умолчанию /evhelp), либо нажав клавишу END"))
				imgui.EndTooltip()
			end
			imgui.SetCursorPosX(10)
			imgui.PushStyleVarVec2(imgui.StyleVar.FramePadding, imgui.ImVec2(5, 3))
			iAnimation.InputTextWithHint(u8"##openmenu", "", openmenu, 128)
			imgui.PopStyleVar(1)
			imgui.SameLine()
			if imgui.Button(faicons("check"), imgui.ImVec2(30, 20)) then
				if ffi.string(openmenu) == "" then
					sampAddChatMessage("{E1B0BA}[Evolve • Helper] {ebebeb}Укажите {E1B0BA}корректную {ebebeb}команду для открытия Evolve Helper", -1)
				else
					thisScript():reload()
					if ffi.string(openmenu) == "" then
						ini.main.openmenucommand = "evhelp"
					else
						ini.main.openmenucommand = ffi.string(openmenu)
					end
					inicfg.save(ini, IniFilename)
				end
			end
		imgui.EndChild()
		imgui.BeginChild("##other", imgui.ImVec2(380, 60))
			imgui.SetCursorPos(imgui.ImVec2(10, 7))
			imgui.PushItemWidth(150)
			imgui.PushFont(fontSize[18])
			imgui.TextDisabled(u8"Социальные сети")
			imgui.PopFont()
			imgui.SetCursorPosX(10)
			if iAnimation.Button("Discord", imgui.ImVec2(100, 20)) then
				os.execute('start https://discord.gg/yC6s65n9u4')
			end
			imgui.SameLine()
			if iAnimation.Button("VK", imgui.ImVec2(70, 20)) then
				os.execute('start https://vk.com/kiruxachance')
			end
			imgui.SameLine()
			if iAnimation.Button("Bug Report", imgui.ImVec2(100, 20)) then
				os.execute('start https://vk.com/kiruxachance')
			end
		imgui.EndChild()	
		end),

		page_t(u8"Модификации", faicons("grid"), function()
-----------------[TAKEMATERIALS]
			imgui.Spacing()
-----------------[TAKEMATERIALS]
			imgui.BeginChild("##takematerials", imgui.ImVec2(380, 40))
			imgui.SetCursorPos(imgui.ImVec2(10, 10))
			imgui.PushItemWidth(150)
			imgui.PushFont(fontSize[18])
			imgui.TextDisabled(u8"Автоматическое взятие материалов")
			imgui.PopFont()
			imgui.SameLine()
			imgui.SetCursorPosY(11)
			if imgui.ToggleButton('', takematerials) then
				ini.funcs.takematerials = not ini.funcs.takematerials
				inicfg.save(ini, IniFilename)
			end
			imgui.SameLine()
			imgui.SetCursorPosX(350)
			imgui.TextDisabled(faicons("list"))
			if imgui.IsItemHovered() then
				imgui.BeginTooltip()
				imgui.TextUnformatted(u8("Автоматически при открытии склада будет брать материалы со склада в нужном количестве"))
				imgui.EndTooltip()
			end
			imgui.EndChild()
-----------------[MATERIALSDNK]
-----------------[MATERIALSDNK]
			imgui.BeginChild("##takematerialsdnk", imgui.ImVec2(380, 80))
			imgui.SetCursorPos(imgui.ImVec2(10, 10))
			imgui.PushItemWidth(150)
			imgui.PushFont(fontSize[18])
			imgui.TextDisabled(u8"Быстрый сейф")
			imgui.PopFont()
			imgui.SameLine()
			imgui.SetCursorPosY(13)
			imgui.SetCursorPosX(350)
			imgui.TextDisabled(faicons("list"))
			if imgui.IsItemHovered() then
				imgui.BeginTooltip()
				imgui.TextUnformatted(u8("При нажатие на заданую клавишу(или сочетание клавиш) будет брать нужное количество материалов/наркотиков с сейфа в ДНК"))
				imgui.EndTooltip()
			end
			imgui.SetCursorPosX(10)
			if imgui.Checkbox(u8"Взятие материалов", takematerialsdnk) then
				ini.funcs.takematerialsdnk = not ini.funcs.takematerialsdnk
				inicfg.save(ini, IniFilename)
			end
			imgui.SameLine()
			if ini.funcs.takematerialsdnk then
				if dnkHotKey:ShowHotKey() then
					ini.funcs.bind = encodeJson(dnkHotKey:GetHotKey())
					inicfg.save(ini, IniFilename)
				end
			end
			imgui.SetCursorPosX(10)
			imgui.SetCursorPosY(55)
			if imgui.Checkbox(u8"Взятие наркотиков", takedrugsdnk) then
				ini.funcs.takedrugsdnk = not ini.funcs.takedrugsdnk
				inicfg.save(ini, IniFilename)
			end
			imgui.SameLine()
			if ini.funcs.takedrugsdnk then
				if drugHotKey:ShowHotKey() then
					ini.funcs.binddrug = encodeJson(drugHotKey:GetHotKey())
					inicfg.save(ini, IniFilename)
				end
			end
			imgui.EndChild()
-----------------[ANTIZEROAMMO]
-----------------[ANTIZEROAMMO]
			local sizeAza = imgui.ImVec2(380, 40) 


			if ini.funcs.azaon then
				sizeAza = imgui.ImVec2(380, 115) 
			end

			imgui.BeginChild("##aza", sizeAza)
			imgui.SetCursorPos(imgui.ImVec2(10, 10))
			imgui.PushItemWidth(150)
			imgui.PushFont(fontSize[18])
			imgui.TextDisabled(u8"Anti Zero Ammo")
			imgui.PopFont()
			imgui.SameLine()
			imgui.SetCursorPosY(11)

			if imgui.ToggleButton('  ', azaon) then
				ini.funcs.azaon = not ini.funcs.azaon
				inicfg.save(ini, IniFilename)
			end

			imgui.SameLine()
			imgui.SetCursorPosX(350)
			imgui.TextDisabled(faicons("list"))
			if imgui.IsItemHovered() then
				imgui.BeginTooltip()
				imgui.TextUnformatted(u8("Автоматически создает указанное количество Deagle при указанном остатке патронов"))
				imgui.EndTooltip()
			end
			if ini.funcs.azaon then 
				imgui.SetCursorPosX(10)
				imgui.Text(u8"Количество, при котором будет создаваться")
				imgui.SetCursorPosX(10)
				imgui.SliderInt(u8'##ff', sliderkolvo, 1, 50)
				imgui.SetCursorPosX(10)
				imgui.Text(u8"Количество, сколько будет создаваться")
				imgui.SetCursorPosX(10)
				imgui.SliderInt(u8"##fff", sliderskolko, 1, 50)
				local sliderValue1 = tonumber(sliderskolko[0])
				if sliderValue1 ~= tonumber(ini.funcs.azaskolko) then
					ini.funcs.azaskolko = tostring(sliderValue1)
					inicfg.save(ini, IniFilename)
				end

				local sliderValue2 = tonumber(sliderkolvo[0])
				if sliderValue2 ~= tonumber(ini.funcs.azakolvo) then
					ini.funcs.azakolvo = tostring(sliderValue2)
					inicfg.save(ini, IniFilename)
				end
			end
			imgui.EndChild()
-----------------[AUTODEAGLE]
-----------------[AUTODEAGLE]
			local sizeAutoDeagle = imgui.ImVec2(380, 40)

			if ini.funcs.autodeagle then
				sizeAutoDeagle = imgui.ImVec2(380, 80) 
			end

			imgui.BeginChild("##autodeagle", sizeAutoDeagle)
			imgui.SetCursorPos(imgui.ImVec2(10, 10))
			imgui.PushItemWidth(150)
			imgui.PushFont(fontSize[18])
			imgui.TextDisabled(u8"Автоматический Deagle")
			imgui.PopFont()
			imgui.SameLine()
			imgui.SetCursorPosY(11)

			if imgui.ToggleButton('   ', autodeagle) then
				ini.funcs.autodeagle = not ini.funcs.autodeagle
				inicfg.save(ini, IniFilename)
			end

			imgui.SameLine()
			imgui.SetCursorPosX(350)
			imgui.TextDisabled(faicons("list"))
			if imgui.IsItemHovered() then
				imgui.BeginTooltip()
				imgui.TextUnformatted(u8("Автоматически после выхода из ДНК будет крафтить указанное количество патронов Desert Eagle\n"))
				imgui.EndTooltip()
			end


			if ini.funcs.autodeagle then
				imgui.SetCursorPosX(10)
				imgui.Text(u8"Количество, сколько будет создаваться")
				imgui.SetCursorPosX(10)
				imgui.SliderInt(u8"##fff", deaglept, 1, 50)
				local sliderValue3 = tonumber(deaglept[0])
				if sliderValue3 ~= tonumber(ini.funcs.autodeaglept) then
					ini.funcs.autodeaglept = tostring(sliderValue3)
					inicfg.save(ini, IniFilename)
				end
			end
			imgui.EndChild()
-----------------[DRUGS]
-----------------[DRUGS]
			imgui.BeginChild("##drugssss", imgui.ImVec2(380, 40))
			imgui.SetCursorPos(imgui.ImVec2(10, 10))
			imgui.PushItemWidth(150)
			imgui.PushFont(fontSize[18])
			imgui.TextDisabled(u8"Использование наркотиков после смерти")
			imgui.PopFont()
			imgui.SameLine()
			imgui.SetCursorPosY(11)
			if imgui.ToggleButton('    ', usnarko) then
				ini.funcs.usnarko = not ini.funcs.usnarko
				inicfg.save(ini, IniFilename)
			end
			imgui.EndChild()
----------------'DNK'
		local sizeDNK = imgui.ImVec2(380, 40) 

		if ini.help.dnkradar then
			sizeDNK = imgui.ImVec2(380, 85)
		end

		imgui.BeginChild("##dnkradar", sizeDNK)
		imgui.SetCursorPos(imgui.ImVec2(10, 10))
		imgui.PushItemWidth(150)
		imgui.PushFont(fontSize[18])
		imgui.TextDisabled(u8"Отображение домов на колёсах")
		imgui.PopFont()
		imgui.SameLine()
		imgui.SetCursorPosY(11)

		if imgui.ToggleButton('', dnkradar) then
			ini.help.dnkradar = not ini.help.dnkradar
			inicfg.save(ini, IniFilename)
		end

		imgui.SameLine()
		imgui.SetCursorPosY(13)
		imgui.SetCursorPosX(350)
		imgui.TextDisabled(faicons("list"))
		if imgui.IsItemHovered() then
			imgui.BeginTooltip()
			imgui.TextUnformatted(u8("Если функция активна, отображает дома на колёсах на радаре\nВы можете изменить иконку, указав ID новой, по стандарту стоит 55 ID (Car)"))
			imgui.EndTooltip()
		end

		if ini.help.dnkradar then
			imgui.SetCursorPosX(10)
			imgui.Text(u8"Введите ID отображаемой иконки")
			imgui.SetCursorPosX(10)
			imgui.PushStyleVarVec2(imgui.StyleVar.FramePadding, imgui.ImVec2(5, 3))
			imgui.InputText(u8"##gfdg", inputiddnk, 16)
			imgui.PopStyleVar(1)
			imgui.SameLine()

			if imgui.Button(faicons("check"), imgui.ImVec2(30, 20)) then
				local inputText = ffi.string(inputiddnk)

				local ids = tonumber(inputText)

				if not ids or ids < 0 or ids > 63 then
					sampAddChatMessage("{E1B0BA}[Evolve • Helper] {ebebeb}Этот {E1B0BA}ID {ebebeb}нельзя установить", -1)
				else
					if ids == 1 or ids == 2 or ids == 4 or ids == 56 then
						sampAddChatMessage("{E1B0BA}[Evolve • Helper] {ebebeb}При использовании этого ID иконки, не включайте легенды в настройках", -1)
					end

					ini.help.dnkradaricon = inputText
					sampAddChatMessage("{E1B0BA}[Evolve • Helper] {ebebeb}Для домов на колёсах установлен {E1B0BA}" .. inputText .. "{ebebeb} ID иконки", -1)
					inicfg.save(ini, IniFilename)
					thisScript():reload()
				end
			end
		end

		imgui.EndChild()
-- [capture]
		imgui.BeginChild("##capture", imgui.ImVec2(380, 65))
		imgui.SetCursorPos(imgui.ImVec2(10, 10))
		imgui.PushItemWidth(150)
		imgui.PushFont(fontSize[18])
		imgui.TextDisabled(u8"Флудер /capture")
		imgui.PopFont()
		imgui.SameLine()
		imgui.SetCursorPosY(13)
		imgui.SetCursorPosX(350)
		imgui.TextDisabled(faicons("list"))
		if imgui.IsItemHovered() then
			imgui.BeginTooltip()
			imgui.TextUnformatted(u8("При использовании указанной команды начинает флудиться /capture с указанной задержкой\nМожно поставить задержку от 300 до 1000 миллисекунд"))
			imgui.EndTooltip()
		end
		imgui.SetCursorPosX(10)
		imgui.PushStyleVarVec2(imgui.StyleVar.FramePadding, imgui.ImVec2(5, 3))
		iAnimation.InputTextWithHint(u8"##capturecmd", "", capturecmd, 16)
		imgui.PopStyleVar(1)
		imgui.SameLine()
		if imgui.Button(faicons("check"), imgui.ImVec2(30, 20)) then
			if ffi.string(capturecmd) == "" then
				sampAddChatMessage("{E1B0BA}[Evolve • Helper] {ebebeb}Укажите {E1B0BA}корректную {ebebeb}команду для флудера", -1)
			else
				thisScript():reload()
				if ffi.string(capturecmd) == "" then
					ini.funcs.capturecmd = "ccapt"
				else
					ini.funcs.capturecmd = ffi.string(capturecmd)
				end
				sampAddChatMessage("{E1B0BA}[Evolve • Helper] {ebebeb}Для флудера установлена команда {E1B0BA}/" .. ini.funcs.capturecmd, -1)
				inicfg.save(ini, IniFilename)
			end
		end	
		imgui.EndChild()
		end),

		page_t(u8"HELPING MENU", faicons("globe"), function()
-----------------[AUTOSELECT]
imgui.Spacing()
-----------------[AUTOSELECT]
		imgui.BeginChild("##dialogs", imgui.ImVec2(380, 100))
		imgui.SetCursorPos(imgui.ImVec2(10, 10))
		imgui.PushItemWidth(150)
		imgui.PushFont(fontSize[18])
		imgui.TextDisabled(u8"Скип диалогов")
		imgui.PopFont()
		imgui.SameLine()
		imgui.SetCursorPosY(13)
		imgui.SetCursorPosX(350)
		imgui.TextDisabled(faicons("list"))
		if imgui.IsItemHovered() then
			imgui.BeginTooltip()
			imgui.TextUnformatted(u8("Выбранный диалог будет скипаться (например диалог в наркопритоне при покупке наркотиков(юзлес диалог))"))
			imgui.EndTooltip()
		end
		imgui.SetCursorPosX(10)
		if imgui.Checkbox(u8"Диалог при покупке наркотиков в притоне", narkopriton) then
			ini.help.narkopriton = not ini.help.narkopriton
			inicfg.save(ini, IniFilename)
		end
		imgui.SetCursorPosX(10)
		if imgui.Checkbox(u8"Предложение установить лаунчер (до 3 lvl)", launcher) then
			ini.help.launcher = not ini.help.launcher
			inicfg.save(ini, IniFilename)
		end
		imgui.SetCursorPosX(10)
		if imgui.Checkbox(u8"Выход из дома на колёсах", dnkvixod) then
			ini.help.dnkvixod = not ini.help.dnkvixod
			inicfg.save(ini, IniFilename)
		end
		imgui.EndChild()
-----------------[HELPER MP]
-----------------[HELPER MP]
		imgui.BeginChild("##mp", imgui.ImVec2(380, 120))
		imgui.SetCursorPos(imgui.ImVec2(10, 10))
		imgui.PushItemWidth(150)
		imgui.PushFont(fontSize[18])
		imgui.TextDisabled(u8"Уведомления о системных мероприятиях")
		imgui.PopFont()
		imgui.SameLine()
		imgui.SetCursorPosY(13)
		imgui.SetCursorPosX(350)
		imgui.TextDisabled(faicons("list"))
		if imgui.IsItemHovered() then
			imgui.BeginTooltip()
			imgui.TextUnformatted(u8("За 5 минут до начала выбранного мероприятия (мероприятий) на экране\nбудет появляться уведомление\nКомандой /events можно посмотреть время проведения всех мероприятий"))
			imgui.EndTooltip()
		end
		imgui.SetCursorPosX(10)
		if imgui.Checkbox(u8"PAINTBALL", paintball) then
			ini.help.paintball = not ini.help.paintball
			inicfg.save(ini, IniFilename)
		end
		imgui.SameLine()
		if imgui.Checkbox(u8"RACING", racing) then
			ini.help.racing = not ini.help.racing
			inicfg.save(ini, IniFilename)
		end
		imgui.SameLine()
		if imgui.Checkbox(u8"DERBY", derby) then
			ini.help.derby = not ini.help.derby
			inicfg.save(ini, IniFilename)
		end
		imgui.SameLine()
		if imgui.Checkbox(u8"BASEJUMPING", base) then
			ini.help.base = not ini.help.base
			inicfg.save(ini, IniFilename)
		end
		imgui.SetCursorPosX(10)
		if imgui.Checkbox(u8"DRIFT", drift) then
			ini.help.drift = not ini.help.drift
			inicfg.save(ini, IniFilename)
		end
		imgui.SetCursorPosX(10)
		imgui.Text(u8"Время отображения в миллисекундах")
		imgui.SetCursorPosX(10)
		imgui.PushItemWidth(225)
		imgui.SliderInt(u8"##vremya", valuempmp, 500, 5000) 
		imgui.PopItemWidth()
		local sliderValue4 = tonumber(valuempmp[0])
		if sliderValue4 ~= tonumber(ini.help.mpvalue) then
			ini.help.mpvalue = tostring(sliderValue4)  
			inicfg.save(ini, IniFilename)
		end
		imgui.EndChild()
------[CHECKONLINE]
------[CHECKONLINE]
		imgui.BeginChild("##checkonline", imgui.ImVec2(380, 65))
		imgui.SetCursorPos(imgui.ImVec2(10, 10))
		imgui.PushItemWidth(150)
		imgui.PushFont(fontSize[18])
		imgui.TextDisabled(u8"Просмотр онлайна в организациях")
		imgui.PopFont()
		imgui.SameLine()
		imgui.SetCursorPosY(13)
		imgui.SetCursorPosX(350)
		imgui.TextDisabled(faicons("list"))
		if imgui.IsItemHovered() then
			imgui.BeginTooltip()
			imgui.TextUnformatted(u8("По указанной вами команде (без /) будет показывать в чат онлайн"))
			imgui.EndTooltip()
		end
		imgui.SetCursorPosX(10)
		imgui.PushStyleVarVec2(imgui.StyleVar.FramePadding, imgui.ImVec2(5, 3))
		iAnimation.InputTextWithHint(u8"##checkonline", "", checkonline, 128)
		imgui.PopStyleVar(1)
		imgui.SameLine()
		if imgui.Button(faicons("check"), imgui.ImVec2(30, 20)) then
			if ffi.string(checkonline) == "" then
				sampAddChatMessage("{E1B0BA}[Evolve • Helper] {ebebeb}Укажите {E1B0BA}корректную {ebebeb}команду для просмотра онлайна организаций", -1)
			else
				thisScript():reload()
				if ffi.string(checkonline) == "" then
					ini.funcs.checkonlinecommand = "co"
				else
					ini.funcs.checkonlinecommand = ffi.string(checkonline)
				end
				inicfg.save(ini, IniFilename)
			end
		end
		imgui.EndChild()
------[РЕЗЕРВ]
------[РЕЗЕРВ]
------[aadmins]
		imgui.BeginChild("##aadmins", imgui.ImVec2(380, 65))
		imgui.SetCursorPos(imgui.ImVec2(10, 10))
		imgui.PushItemWidth(150)
		imgui.PushFont(fontSize[18])
		imgui.TextDisabled(u8"Просмотр администрации онлайн")
		imgui.PopFont()
		imgui.SameLine()
		imgui.SetCursorPosY(13)
		imgui.SetCursorPosX(350)
		imgui.TextDisabled(faicons("list"))
		if imgui.IsItemHovered() then
			imgui.BeginTooltip()
			imgui.TextUnformatted(u8("При использовании указанной команды выводит список администрации онлайн в чат\nСписок администрации постоянно обновляется"))
			imgui.EndTooltip()
		end
		imgui.SetCursorPosX(10)
		imgui.PushStyleVarVec2(imgui.StyleVar.FramePadding, imgui.ImVec2(5, 3))
		iAnimation.InputTextWithHint(u8"##adminscmd", "", adminscmd, 128)
		imgui.PopStyleVar(1)
		imgui.SameLine()
		if imgui.Button(faicons("check"), imgui.ImVec2(30, 20)) then
			if ffi.string(adminscmd) == "" then
				sampAddChatMessage("{E1B0BA}[Evolve • Helper] {ebebeb}Укажите {E1B0BA}корректную {ebebeb}команду для просмотра администрации онлайн", -1)
			else
				thisScript():reload()
				if ffi.string(adminscmd) == "" then
					ini.help.adminscmd = "aadmins"
				else
					ini.help.adminscmd = ffi.string(adminscmd)
				end
				sampAddChatMessage("{E1B0BA}[Evolve • Helper] {ebebeb}Для просмотра администрации онлайн установлена команда {E1B0BA}/" .. ini.help.adminscmd, -1)
				inicfg.save(ini, IniFilename)
			end
		end
		imgui.EndChild()
------[FCR]
		imgui.BeginChild("##fcr", imgui.ImVec2(380, 40))
		imgui.SetCursorPos(imgui.ImVec2(10, 10))
		imgui.PushItemWidth(150)
		imgui.PushFont(fontSize[18])
		imgui.TextDisabled(u8"Быстрый спавн семейного транспорта")
		imgui.PopFont()
		imgui.SameLine()
		imgui.SetCursorPosY(13)
		imgui.TextDisabled(faicons("list"))
		if imgui.IsItemHovered() then
			imgui.BeginTooltip()
			imgui.TextUnformatted(u8("Находясь в семейном доме, при вводе команды /fcr (от 1 до 5) спавнит выбранный слот машины"))
			imgui.EndTooltip()
		end
		imgui.EndChild()
		end),

		page_t(u8"Change Log", faicons("pen"), function()
-- [ VERSION 1.4.6]
			imgui.Spacing()
			imgui.BeginChild("##changelog1.4.6", imgui.ImVec2(380, 65))
			imgui.Spacing()
			imgui.SetCursorPosX(10)
			imgui.PushFont(fontSize[18])
			imgui.TextDisabled("1.4.6")
			imgui.PopFont()
			imgui.SetCursorPosX(10)
			imgui.Text(u8"Изменения:\n- Улучшена работа автоматического обновления")
			imgui.SetCursorPosX(10)
			imgui.EndChild()
-- [ VERSION 1.4.2]
			imgui.BeginChild("##changelog1.4.2", imgui.ImVec2(380, 93))
			imgui.Spacing()
			imgui.SetCursorPosX(10)
			imgui.PushFont(fontSize[18])
			imgui.TextDisabled("1.4.2")
			imgui.PopFont()
			imgui.SetCursorPosX(10)
			imgui.Text(u8"Добавлено:\n- Флудер /capture с указанной задержкой [FUNCS]\n- Открытие меню нажатием клавиши END [ALL]\n- Автоматическое обновление скрипта [ALL]")
			imgui.SetCursorPosX(10)
			imgui.EndChild()
-- [ VERSION 1.4.1]
			imgui.BeginChild("##changelog1.4.1", imgui.ImVec2(380, 135))
			imgui.Spacing()
			imgui.SetCursorPosX(10)
			imgui.PushFont(fontSize[18])
			imgui.TextDisabled("1.4.1")
			imgui.PopFont()
			imgui.SetCursorPosX(10)
			imgui.Text(u8"Добавлено:\n- Скип диалога выхода из дома на колёсах [HELP]\n\nИсправлено:\n- При использовании /fcr аргумент совпадает со слотом\n семейного автомобиля [HELP]\n- Визуальные изменения меню функций [ALL]")
			imgui.SetCursorPosX(10)
			imgui.EndChild()
-- [ VERSION 1.4.0]
			imgui.BeginChild("##changelog1.4.0", imgui.ImVec2(380, 80))
			imgui.Spacing()
			imgui.SetCursorPosX(10)
			imgui.PushFont(fontSize[18])
			imgui.TextDisabled("1.4.0")
			imgui.PopFont()
			imgui.SetCursorPosX(10)
			imgui.Text(u8"Добавлено:\n- Спавн семейного транспорта командой /fcr [HELP]\n- Изменение команды просмотра администрации [HELP]")
			imgui.SetCursorPosX(10)
			imgui.EndChild()
-- [ VERSION 1.3.9]
			imgui.BeginChild("##changelog1.3.9", imgui.ImVec2(380, 80))
			imgui.Spacing()
			imgui.SetCursorPosX(10)
			imgui.PushFont(fontSize[18])
			imgui.TextDisabled("1.3.9")
			imgui.PopFont()
			imgui.SetCursorPosX(10)
			imgui.Text(u8"Изменения:\n- Улучшена работа функции администрации онлайн [HELP]\n- Добавлен вывод уровня и ID администратора [HELP]")
			imgui.SetCursorPosX(10)
			imgui.EndChild()
-- [ VERSION 1.3.8 ]
			imgui.BeginChild("##changelog1.3.8", imgui.ImVec2(380, 65))
			imgui.Spacing()
			imgui.SetCursorPosX(10)
			imgui.PushFont(fontSize[18])
			imgui.TextDisabled("1.3.8")
			imgui.PopFont()
			imgui.SetCursorPosX(10)
			imgui.Text(u8"Добавлено:\n- Просмотр администрации онлайн командой /aadmins [HELP]")
			imgui.SetCursorPosX(10)
			imgui.EndChild()
-- [ VERSION 1.2.8 ]
			imgui.BeginChild("##changelog1.2.8", imgui.ImVec2(380, 95))
			imgui.Spacing()
			imgui.SetCursorPosX(10)
			imgui.PushFont(fontSize[18])
			imgui.TextDisabled("1.2.8")
			imgui.PopFont()
			imgui.SetCursorPosX(10)
			imgui.Text(u8"Изменения:\n- Отображение домов на колёсах [FUNCS]\n- Использование наркотиков после смерти [FUNCS]\n- Добавлены логи AddedBlips (/bliplog)")
			imgui.SetCursorPosX(10)
			imgui.EndChild()
-- [ VERSION 1.2.7 ]
			imgui.BeginChild("##changelog1.2.7", imgui.ImVec2(380, 65))
			imgui.Spacing()
			imgui.SetCursorPosX(10)
			imgui.PushFont(fontSize[18])
			imgui.TextDisabled("1.2.7")
			imgui.PopFont()
			imgui.SetCursorPosX(10)
			imgui.Text(u8"Добавлено:\n- Установка своего ID иконки дома на колёсах [FUNCS]")
			imgui.SetCursorPosX(10)
			imgui.EndChild()
-- [ VERSION 1.2.6 ]
			imgui.BeginChild("##changelog1.2.6", imgui.ImVec2(380, 125))
			imgui.Spacing()
			imgui.SetCursorPosX(10)
			imgui.PushFont(fontSize[18])
			imgui.TextDisabled("1.2.6")
			imgui.PopFont()
			imgui.SetCursorPosX(10)
			imgui.Text(u8"Добавлено:\n- Отображение домов на колёсах на радаре [FUNCS]\n\nИсправлено:\n- Использование наркотиков после смерти [FUNCS]\n- Просмотр онлайна в организациях [HELP]")
			imgui.SetCursorPosX(10)
			imgui.EndChild()
-- [ VERSION 1.1.6 ]
			imgui.BeginChild("##changelog1.1.6", imgui.ImVec2(380, 95))
			imgui.Spacing()
			imgui.SetCursorPosX(10)
			imgui.PushFont(fontSize[18])
			imgui.TextDisabled("1.1.6")
			imgui.PopFont()
			imgui.SetCursorPosX(10)
			imgui.Text(u8"Добавлено:\n- Использование наркотиков после смерти [FUNCS]\n- Скип диалогов [HELP]\n- Просмотр онлайна в организациях [HELP]")
			imgui.EndChild()	
		end)
	}

	pages[0] = pages[1]

	function this:draw()
		imgui.Begin("##window", self.status, self.flags)
			imgui.PushFont(fontSize[18])
			imgui.Text("EVOLVE HELPER")
			imgui.PopFont()
			imgui.SameLine()
			imgui.TextDisabled("1.4.7")
			imgui.SameLine()
			imgui.SetCursorPosX(400)
			imgui.Text(faicons("ghost"))
			if imgui.IsItemHovered() then
				imgui.BeginTooltip()
				imgui.TextUnformatted(u8("Thanks to them for their help in testing\n ^ Pashok King\n ^ Pay Pal\n ^ Wanderlust Fearless\n ^ Examples Ogsider"))
				imgui.EndTooltip()
			end

			imgui.Spacing()

			imgui.BeginChild("##navigation", imgui.ImVec2(168, 27))
				imgui.SetCursorPos(imgui.ImVec2(5, 5))
				imgui.BeginGroup()
					for i, v in ipairs(pages) do
						imgui.SameLine()
						imgui.SetCursorPosY(3)
						if iAnimation.NoAlphaButton(v.icon, imgui.ImVec2(30, 20)) then
							pages[0] = v
						end
					end
				imgui.EndGroup()
			imgui.EndChild()


			imgui.SetNextWindowBgAlpha(0)
			imgui.BeginChild("##body", imgui.ImVec2(400, 285))
				imgui.SetNextWindowBgAlpha(0)
				imgui.BeginChild("##body__content", imgui.ImVec2(390, 280), false, imgui.WindowFlags.NoScrollWithMouse)
					iAnimationScroll("##body__content__scroll", 50, 0.4)
					pages[0].draw()
				imgui.EndChild()
			imgui.EndChild()
		imgui.End()
	end

	return this
end)

imgui.OnInitialize(function()
	local fontPath = getFolderPath(0x14) .. "\\trebucbd.ttf"
	local glyphRanges = imgui.GetIO().Fonts:GetGlyphRangesCyrillic()
	fontSize = {}

	local config = imgui.ImFontConfig()
	config.MergeMode = true
	config.PixelSnapH = true

	imgui.GetIO().Fonts:Clear()
	imgui.GetIO().Fonts:AddFontFromFileTTF(fontPath, 14, nil, glyphRanges)

	local base = faicons.get_font_data_base85("solid")
	local iconRanges = imgui.new.ImWchar[3](faicons.min_range, faicons.max_range, 0)
	imgui.GetIO().Fonts:AddFontFromMemoryCompressedBase85TTF(base, 12, config, iconRanges)

	for k, v in ipairs({ 18 }) do
		fontSize[v] = imgui.GetIO().Fonts:AddFontFromFileTTF(fontPath, v, nil, glyphRanges)
		imgui.GetIO().Fonts:AddFontFromMemoryCompressedBase85TTF(base, v, config, iconRanges)
	end

	iAnimation("NoAlphaButton", imgui.Col.Text, imgui.Col.TextDisabled, imgui.Col.Text, 0.4)
	iAnimation("Button", imgui.Col.Button, imgui.Col.ButtonHovered, imgui.Col.ButtonActive, 0.4)
	iAnimation("InputTextWithHint", imgui.Col.FrameBg, imgui.Col.FrameBgHovered, imgui.Col.FrameBgActive, 0.4)

	-- applyCustomStyle(0xFF193340, 0xE0040B0E, 0xFFFFFFFF) --1 - кнопки, 2 - imgui, 3 - текст
	applyCustomStyle(0x83ffcbe2, 0xE0070808, 0xFFFFFFFF) --1 - кнопки, 2 - imgui, 3 - текст
end)

function main()
    if not isSampfuncsLoaded() or not isSampLoaded() then return end
    while not isSampAvailable() do wait(1500) end
    wait(1000)
	sampAddChatMessage("{E1B0BA}[Evolve • Helper] {ebebeb}Menu: {E1B0BA}" .. ini.main.openmenucommand .. " {ebebeb}Author: {E1B0BA}petya.sushkin", -1)
    window = window()

	sampRegisterChatCommand(ini.main.openmenucommand, function() window:switch() end)
	sampRegisterChatCommand("events", function() showdialogmp() end)
	sampRegisterChatCommand("bliplog", function() showaddlogs() end)
	sampRegisterChatCommand("fcr", function(arg)
		local soption = tonumber(arg)
		if soption and soption >= 1 and soption <= 5 then
			soption = soption - 1
			selectdialogfcr = true
			sdialogopt = soption
			send_alt()
		else
			sampAddChatMessage("{E1B0BA}[Evolve • Helper] {ebebeb}Выберите слот семейного транспорта от {E1B0BA}1 {ebebeb}до {E1B0BA}5", -1)
		end
	end)
	sampRegisterChatCommand(ini.funcs.capturecmd, function(args)
		if floodon then
			floodon = false
			printStringNow(("flood capture ~r~off"), 1000)
		else
			local delay = tonumber(args)
			if delay and delay >= 300 and delay <= 1500 then
				flooddelay = delay
				floodon = true
				printStringNow(("flood capture ~y~" .. flooddelay), 1000)
			else
				sampAddChatMessage("{E1B0BA}[Evolve • Helper] {ebebeb}Неверное значение, укажите задержку в миллисекундах от 300 до 1000", -1)
			end
		end
	end)
	
	local evolverp = sampGetCurrentServerName()

    if evolverp ~= "Evolve-Rp.Ru" then
        addOneOffSound(0.0, 0.0, 0.0, 1057)

        sampRegisterChatCommand(ini.funcs.checkonlinecommand, function()
            local text = texts[1]
            local clist = clists[1]

            for i = 1, #clist do
                local online = 0

                for l = 0, 1004 do
                    if sampIsPlayerConnected(l) then
                        if sampGetPlayerColor(l) == clist[i] then
                            online = online + 1
                        end
                    end
                end

                text = text:gsub('$CLR', ('%06X'):format(bit.band(clist[i], 0xFFFFFF)), 1)
                text = text:gsub('$CNT', online, 1)
            end

            for w in text:gmatch('[^\r\n]+') do
                sampAddChatMessage(w, -1)
            end
        end)
    end

	dnkHotKey = hotkey.RegisterHotKey('hotkeymaterials', false, decodeJson(ini.funcs.bind), function() 
		if ini.funcs.takematerialsdnk then
			sampSendChat("/safe material " .. (500 - tonumber(ini.main.materials) or 0))
		end
	end)

	drugHotKey = hotkey.RegisterHotKey('hotkeydrug', false, decodeJson(ini.funcs.binddrug), function() 
		if ini.funcs.takedrugsdnk then
			sampSendChat("/safe drug " .. (500 - tonumber(ini.main.drugs) or 0))
		end
	end)

	wait(4000)
	downloadUrlToFile(update_url, update_path, function(id, status)
		if status == dlstatus.STATUS_ENDDOWNLOADDATA then
			updateIni = inicfg.load(nil, update_path)
			if tonumber(updateIni.INFO.vers) > script_vers then
				sampAddChatMessage("{E1B0BA}[Evolve • Helper] {ebebeb}Имеется {E1B0BA}обновления", -1)
				update_state = true
			end
			os.remove(update_path)
		end
	end)

	
    while true do
        wait(1)

		if update_state then
			downloadUrlToFile(script_url, script_path, function(id, status)
				if status == dlstatus.STATUS_ENDDOWNLOADDATA then
					sampAddChatMessage("{E1B0BA}[Evolve • Helper] {ebebeb}Скрипт успешно обновлен", -1)
					thisScript():reload()
				end
			end)
			break
		end

		local azakolvopt = tonumber(ini.funcs.azakolvo)
		local azaskolkopt = tonumber(ini.funcs.azaskolko) 
		if azazlo == false then 
			prevammo = getAmmoInCharWeapon(PLAYER_PED, 24)
			if prevammo == azakolvopt and ini.funcs.azaon then 
				_, id = sampGetPlayerIdByCharHandle(PLAYER_PED)
				sampSendChat(string.format("/sellgun deagle %d 100 %d", azaskolkopt, id))
				nowammo = getAmmoInCharWeapon(PLAYER_PED, 24)		
			end
		end

		local hp = getCharHealth(PLAYER_PED) 
		if sampIsLocalPlayerSpawned() then
			if ini.funcs.usnarko == true and hp == 0 then
				sampSendChat("/usedrugs 15")
				wait(2500)
			elseif ini.funcs.usnark == false then
			end
		end

		if floodon then
            sampSendChat("/capture")
            wait(flooddelay)
        end 

		if isKeyJustPressed(VK_END) then window:switch() end
    end
end

function imgui.NoAlphaButton(str_id, size)
	local color = imgui.ImVec4(0, 0, 0, 0)
	imgui.PushStyleColor(imgui.Col.Button, color)
	imgui.PushStyleColor(imgui.Col.ButtonActive, color)
	imgui.PushStyleColor(imgui.Col.ButtonHovered, color)
	local result = imgui.Button(str_id, size)
	imgui.PopStyleColor(3)
	return result
end

iAnimation = (function()
	local this = {}
	local metatable = {}
	local ui = {}

	local function bringVec4To(from, to, sclock, duration)
		local clock = os.clock() - sclock
		if clock >= 0 and clock <= duration then
			local k = clock / (duration / 100)
			return imgui.ImVec4 (
				from.x + (k * (to.x - from.x) / 100),
				from.y + (k * (to.y - from.y) / 100),
				from.z + (k * (to.z - from.z) / 100),
				from.w + (k * (to.w - from.w) / 100)
			), true
		end
		return (clock > duration) and to or from, false
	end

	function this:init(element, default, hovered, active, duration)
		local t = {}
		local m = {}

		t.__element = element
		t.__duration = duration or 0.4
		t.__colors = {
			default = default,
			hovered = hovered,
			active = active
		}

		function m:__call(str_id, ...)
			local result, color, status, index

			if self[str_id].clock then
				color, status = bringVec4To(self[str_id].from, self[str_id].to, self[str_id].clock, self.__duration)
				if not status then
					self[str_id].clock = false
				end
			else
				color = imgui.GetStyle().Colors[self[str_id].index]
			end

			imgui.PushStyleColor(self.__colors.default, color)
			imgui.PushStyleColor(self.__colors.hovered, color)
			imgui.PushStyleColor(self.__colors.active, color)
			result = imgui[self.__element](str_id, ...)
			imgui.PopStyleColor(3)

			if imgui.IsItemActive() then
				index = self.__colors.active
			elseif imgui.IsItemHovered() then 
				index = self.__colors.hovered
			else
				index = self.__colors.default
			end

			if self[str_id].index ~= index then
				self[str_id] = {
					index = index,
					clock = os.clock(),
					from = imgui.GetStyle().Colors[self[str_id].index],
					to = imgui.GetStyle().Colors[index]
				}
			end

			return result
		end

		function m:__index(k)
			self[k] = { index = self.__colors.default }
			return self[k]
		end

		ui[element] = setmetatable(t, m)
	end

	function metatable:__index(element)
		return ui[element]
	end

	metatable.__call = this.init

	return setmetatable(this, metatable)
end)()

iAnimationScroll = (function()
	local this = {}
	local flags = imgui.HoveredFlags.AnyWindow

	local ui = setmetatable({}, {
		__index = function(t, k)
			t[k] = {}
			return t[k]
		end
	})

	function this:call(str_id, step, duration, flag)
		local scroll = imgui.GetScrollY()
		local el = ui[str_id]
		flag = flag or flags
	
		if imgui.IsWindowHovered(flag) and imgui.IsMouseDown(0) then
			el.sclock = false
		end

		if el.sclock then
			if os.clock() - el.sclock <= duration then
				local k = (os.clock() - el.sclock) / duration
				local fk = k * (2 - k)
				local n = el.sposition + (el.tposition - el.sposition) * (k * (2 - k))

				if n < 0 then
					n = 0
					el.sclock = false
				elseif n > imgui.GetScrollMaxY() then
					n = imgui.GetScrollMaxY()
					el.sclock = false
				end

				imgui.SetScrollY(math.floor(n))
			else
				el.sclock = false
				imgui.SetScrollY(el.tposition)
			end
		end

		local wheel = imgui.GetIO().MouseWheel

		if wheel ~= 0 and imgui.IsWindowHovered(flag) then
			local offset = -wheel * step

			if el.sclock then
				el.sclock = os.clock()
				el.sposition = scroll

				if el.sposition < el.tposition and offset > 0 then
					el.tposition = el.tposition + offset
				elseif el.sposition > el.tposition and offset < 0 then
					el.tposition = el.tposition + offset
				else
					el.tposition = scroll + offset
				end
			else
				el.sclock = os.clock()
				el.sposition = scroll
				el.tposition = scroll + offset
			end
		end
	end

	return setmetatable(this, { __call = this.call })
end)()

function ev.onServerMessage(color, text)
	if text:find('Открыл %{......%}доступ к склад') and ini.funcs.takematerials then
		lua_thread.create(function()
			wait(20)
			sampSendChat('/get guns 0')
		end)
	end
	if text:find('Осталось материалов: (%d+)') then
		ini.main.materials = text:match('^ Осталось материалов: (%d+)')
		inicfg.save(ini, IniFilename)
	end

	if text:find('Остаток: (%d+) грамм растительных наркотиков') then
		ini.main.drugs = text:match('Остаток: (%d+) грамм растительных наркотиков')
		inicfg.save(ini, IniFilename)
	end

	if text:find('У Вас недостаточно материалов!') then
		ini.main.materials = 25
		inicfg.save(ini, IniFilename)
	end

	if ini.help.paintball then
		if text:find('Внимание! Начало %{......%}"Paint Ball" %{......%}через 5 минут.') then
			printStyledString('~g~PAINTBALL ~r~5 ~g~minutes', ini.help.mpvalue, 7)
		end
	end
	if ini.help.drift then
		if text:find('Внимание! Начало %{......%}"Drift" %{......%}через 5 минут.') then
			printStyledString('~g~DRIFT ~r~5 ~g~minutes', ini.help.mpvalue, 7)
		end
	end
	if ini.help.racing then
		if text:find('Внимание! Начало %{......%}"Racing" %{......%}через 5 минут.') then
			printStyledString('~g~RACING ~r~5 ~g~minutes', ini.help.mpvalue, 7)
		end
	end
	if ini.help.derby then
		if text:find('Внимание! Начало %{......%}"Derby" %{......%}через 5 минут.') then
			printStyledString('~g~DERBY ~r~5 ~g~minutes', ini.help.mpvalue, 7)
		end
	end
	if ini.help.base then
		if text:find('Внимание! Начало %{......%}"Base Jump" %{......%}через 5 минут.') then
			printStyledString('~g~BASEJUMPING ~r~5 ~g~minutes', ini.help.mpvalue, 7)
		end
	end
	if text:find('Не флуди!') and not text:find('- ') then 
        return false 
    end
end

function getCurrentServer(name)
    if name:find('Evolve%-Rp') then return 1 end
end

function ev.onShowDialog(id, style, title, button1, button2, text)
	if ini.funcs.autodeagle then
		if style == 0 and title:find("Выход | %{......%}Транспорт") then
			sampSendDialogResponse(id, 1, 0, 0)
			_, id = sampGetPlayerIdByCharHandle(PLAYER_PED)
			deagleest = getAmmoInCharWeapon(PLAYER_PED, 24)
			if deagleest == 0 then
				sampSendChat(string.format("/sellgun deagle %d 100 %d", ini.funcs.autodeaglept, id))
			end
			return false
		end
	end

	if ini.help.dnkvixod then
		if style == 0 and title:find("Выход | %{......%}Транспорт") then
			sampSendDialogResponse(id, 1, 0, 0)
			return false
		end
	end

	if ini.help.narkopriton then
		if style == 0 and title:find("Наркопритон | %{......%}Покупка наркотиков") then
			sampSendDialogResponse(id, 1, 0xFFFF, 0)
			return false
		end
	end

	if ini.help.launcher then
		if style == 0 and title:find("Игровой лаунчер |") then
			sampSendDialogResponse(id, 1, 0xFFFF)
			return false
		end
	end

    if style == 0 and title:find("%{......%}Подтверждение | %{......%}Парковка семейного ТС") or title:find("Подтверждение | %{......%}Удаление семейного ТС") then
        sampSendDialogResponse(id, 1, 7)
		closeNextDialog = true
        return false
    end

	if closeNextDialog and id == 6707 then
        sampSendDialogResponse(id, 0, 0) 
        closeNextDialog = true  
        return false
    end

	if closeNextDialog and id == 6700 then
        sampSendDialogResponse(id, 0, 0) 
        closeNextDialog = false  
        return false
    end

    if not selectdialogfcr then
        return true
    end

    if style == 2 and title:find("%{......%}Дом") then
        sampSendDialogResponse(id, 1, 7)
        return false
    end

    if style == 5 and title:find("Перечень | %{......%}Автомобили") then
        sampSendDialogResponse(id, 1, sdialogopt)
		selectdialogfcr = false
        return false
    end
end


function showdialogmp()
	sampShowDialog(100, "{FFFFFF}Серверные мероприятия Evolve RP", "{FFFFFF}{FFCC99}                               « Расписание мероприятий »{FFFFFF}\n\n{FFFF99}             Paint Ball{FFFFFF}{FF3300}     Drift{FFFFFF}{3366FF}     Base Jump{FFFFFF}{FF6633}     Derby{FFFFFF}     Racing{FFFFFF}{FF6633}\n\n{FFFFFF}                 05:30       06:15         07:00             07:45        2:00{FFFFFF}\n{FFFFFF}                 08:30       09:15         10:00             10:45        5:10{FFFFFF}\n{FFFFFF}                 11:30       12:15         13:00             13:45        8:00{FFFFFF}\n{FFFFFF}                 14:30       15:15         16:00             16:45        11:00{FFFFFF}\n{FFFFFF}                 17:30       18:15         19:00             19:45        14:00{FFFFFF}\n{FFFFFF}                 20:30       21:15         22:00             22:45        17:00{FFFFFF}\n{FFFFFF}                 23:30       00:15         01:00             01:45        20:00{FFFFFF}\n{FFFFFF}                 02:30       03:15         04:00             04:45        23:00{FFFFFF}\n\n{FFCC99}  Награды за призовые места в понедельник после рестарта {FFFFFF}\n\n{FFFFFF}                                     1 место  —  $1.000.000\n{FFFFFF}                                     2 место  —  $500.000\n{FFFFFF}                                     3 место  —  $250.000", "52")
end

function logAddedBlipsAction(action, VehId, entry)
    local logMessage = ""
    if action == "add" then
        logMessage = string.format("Добавлен новый blip для автомобиля: VehId %d, позиция (%.2f, %.2f, %.2f), BlipHandle: %d", 
            VehId, entry.PosX, entry.PosY, entry.PosZ, entry.bHandle)
    elseif action == "update" then
        logMessage = string.format("Обновлена позиция blip для автомобиля: VehId %d, новая позиция (%.2f, %.2f, %.2f)", 
            VehId, entry.PosX, entry.PosY, entry.PosZ)
    elseif action == "remove" then
        logMessage = string.format("Удален blip для автомобиля: VehId %d, BlipHandle: %d", VehId, entry.bHandle)
    elseif action == "clear" then
        logMessage = "Список AddedBlips очищен"
    end
    table.insert(AddLogs, logMessage)
end

function isRadarEnabled()
    return ini.help.dnkradar == true
end

function ev.onVehicleStreamIn(VehId, data)
    if not isRadarEnabled() then return end 

    if data.type == 508 then
        if not AddedBlips[VehId] then
            local blip_handle = addSpriteBlipForCoord(data.position.x, data.position.y, data.position.z, dnkradaricon)
            changeBlipScale(blip_handle, 2)
            changeBlipColour(blip_handle, 0xffe07e77)
            
            local entry = {
                VehId = VehId,
                PosX = data.position.x,
                PosY = data.position.y,
                PosZ = data.position.z,
                bHandle = blip_handle
            }
            AddedBlips[VehId] = entry
            logAddedBlipsAction("add", VehId, entry)
        end
    end
end

function ev.onVehicleSync(playerId, VehId, data)
    local entry = AddedBlips[VehId]
    if entry then
        entry.PosX = data.position.x
        entry.PosY = data.position.y
        entry.PosZ = data.position.z
        setBlipCoordinates(entry.bHandle, data.position.x, data.position.y, data.position.z)
        logAddedBlipsAction("update", VehId, entry)
    end
end

function ev.onVehicleStreamOut(VehId)
    local entry = AddedBlips[VehId]
    if entry then
        removeBlip(entry.bHandle)
        AddedBlips[VehId] = nil
        logAddedBlipsAction("remove", VehId, entry) 
    end
end

function ev.onSendEnterVehicle(VehId, pas)
    local entry = AddedBlips[VehId]
    if entry then
        removeBlip(entry.bHandle)
        AddedBlips[VehId] = nil
        logAddedBlipsAction("remove", VehId, entry) 
    end
end

function ev.onSendClientJoin()
    for VehId, entry in pairs(AddedBlips) do
        removeBlip(entry.bHandle)
    end
    AddedBlips = {}
    logAddedBlipsAction("clear")
end

addEventHandler('onScriptTerminate', function(scr)
    if scr == script.this then
        print("\n-------------------------------------------------------\nСписок AddedBlips был очищен\n-------------------------------------------------------")
        for _, entry in pairs(AddedBlips) do
            removeBlip(entry.bHandle)
        end
        AddedBlips = {}
        logAddedBlipsAction("clear")
    end
end)

function printAddedBlips()
    for VehId, entry in pairs(AddedBlips) do
        print(string.format("VehId: %d, PosX: %.2f, PosY: %.2f, PosZ: %.2f, BlipHandle: %d", VehId, entry.PosX, entry.PosY, entry.PosZ, entry.bHandle))
    end
end

function showaddlogs()
    local logText = ""
    for i, logMessage in ipairs(AddLogs) do
        logText = logText .. logMessage .. "\n"
    end
    if logText == "" then
        logText = "Нет доступных логов."
    end
    sampShowDialog(1, "{FFFFFF}Логирование {ebebeb}AddedBlips", logText, "Закрыть", "", 2)
end

function getServerIP()
    return sampGetCurrentServerAddress()
end


function updateAdminsList()
    local server_ip = getServerIP()

    if server_ip ~= currentServerIP then
        currentServerIP = server_ip

        if server_ip == "185.169.134.67" then
            admins = admins_server1
        elseif server_ip == "185.169.134.68" then
            admins = admins_server2
        else
            admins = nil 
            sampAddChatMessage("{E1B0BA}[Evolve • Helper] {ebebeb}Это не {E1B0BA}Evolve RP{ebebeb}, я спать бб", -1) 
        end
    end
end

function ev.onSendCommand(cmd)
    local command, params = string.match(cmd, "^%/([^ ]*)(.*)")
    if command ~= nil and params ~= nil and command:lower() == ini.help.adminscmd then
        updateAdminsList() 
        showAdminsList() 
        return false
    end
end

function showAdminsList()
    local onlineAdmins = {}

    -- Проверка, что admins не nil
    if admins == nil then
        return
    end

    for i = 0, 999 do
        if sampIsPlayerConnected(i) then
            local name = sampGetPlayerNickname(i)
            for _, admin in ipairs(admins) do
                if name == admin[1] then  -- admin[1] — это имя
                    local playerId = i
                    local level = admin[2]  -- admin[2] — это уровень
                    table.insert(onlineAdmins, {name = name, id = playerId, level = level})
                end
            end
        end
    end

    local count = #onlineAdmins

    if count > 0 then
		sampAddChatMessage("{d2cf68}Администрация онлайн: ", -1)  
        for _, admin in ipairs(onlineAdmins) do
            sampAddChatMessage(string.format("{dccda9}%s | ID: %d | LVL %d", admin.name, admin.id, admin.level), -1)
        end
    else
        sampAddChatMessage("Нет администраторов онлайн.", -1)
    end
end

function samp_create_sync_data(sync_type, copy_from_player)
    local ffi = require 'ffi'
    local sampfuncs = require 'sampfuncs'
    local raknet = require 'samp.raknet'
    require 'samp.synchronization'

    copy_from_player = copy_from_player or true
    local sync_traits = {
        player = {'PlayerSyncData', raknet.PACKET.PLAYER_SYNC, sampStorePlayerOnfootData},
        vehicle = {'VehicleSyncData', raknet.PACKET.VEHICLE_SYNC, sampStorePlayerIncarData},
        passenger = {'PassengerSyncData', raknet.PACKET.PASSENGER_SYNC, sampStorePlayerPassengerData},
        aim = {'AimSyncData', raknet.PACKET.AIM_SYNC, sampStorePlayerAimData},
        trailer = {'TrailerSyncData', raknet.PACKET.TRAILER_SYNC, sampStorePlayerTrailerData},
        unoccupied = {'UnoccupiedSyncData', raknet.PACKET.UNOCCUPIED_SYNC, nil},
        bullet = {'BulletSyncData', raknet.PACKET.BULLET_SYNC, nil},
        spectator = {'SpectatorSyncData', raknet.PACKET.SPECTATOR_SYNC, nil}
    }
    local sync_info = sync_traits[sync_type]
    local data_type = 'struct ' .. sync_info[1]
    local data = ffi.new(data_type, {})
    local raw_data_ptr = tonumber(ffi.cast('uintptr_t', ffi.new(data_type .. '*', data)))
    
    if copy_from_player then
        local copy_func = sync_info[3]
        if copy_func then
            local _, player_id
            if copy_from_player == true then
                _, player_id = sampGetPlayerIdByCharHandle(PLAYER_PED)
            else
                player_id = tonumber(copy_from_player)
            end
            copy_func(player_id, raw_data_ptr)
        end
    end
    
    local func_send = function()
        local bs = raknetNewBitStream()
        raknetBitStreamWriteInt8(bs, sync_info[2])
        raknetBitStreamWriteBuffer(bs, raw_data_ptr, ffi.sizeof(data))
        raknetSendBitStreamEx(bs, sampfuncs.HIGH_PRIORITY, sampfuncs.UNRELIABLE_SEQUENCED, 1)
        raknetDeleteBitStream(bs)
    end
    
    local mt = {
        __index = function(t, index)
            return data[index]
        end,
        __newindex = function(t, index, value)
            data[index] = value
        end
    }
    
    return setmetatable({send = func_send}, mt)
end

function send_alt()
    local data = samp_create_sync_data('player')
    data.keysData = 1024
    data.send()
end

function imgui.ToggleButton(str_id, bool)
    local rBool = false

    if LastActiveTime == nil then
        LastActiveTime = {}
    end
    if LastActive == nil then
        LastActive = {}
    end

    local function ImSaturate(f)
        return f < 0.0 and 0.0 or (f > 1.0 and 1.0 or f)
    end

    local p = imgui.GetCursorScreenPos()
    local dl = imgui.GetWindowDrawList()

    local height = imgui.GetTextLineHeightWithSpacing()
    local width = height * 1.70
    local radius = height * 0.50
    local ANIM_SPEED = type == 2 and 0.25 or 0.25
    local butPos = imgui.GetCursorPos()

    if imgui.InvisibleButton(str_id, imgui.ImVec2(width, height)) then
        bool[0] = not bool[0]
        rBool = true
        LastActiveTime[tostring(str_id)] = os.clock()
        LastActive[tostring(str_id)] = true
    end

    imgui.SetCursorPos(imgui.ImVec2(butPos.x + width + 8, butPos.y + 2.5))
    imgui.Text( str_id:gsub('##.+', '') )

    local t = bool[0] and 1.0 or 0.0

    if LastActive[tostring(str_id)] then
        local time = os.clock() - LastActiveTime[tostring(str_id)]
        if time <= ANIM_SPEED then
            local t_anim = ImSaturate(time / ANIM_SPEED)
            t = bool[0] and t_anim or 1.0 - t_anim
        else
            LastActive[tostring(str_id)] = false
        end
    end

    local col_circle = bool[0] and imgui.ColorConvertFloat4ToU32(imgui.ImVec4(imgui.GetStyle().Colors[imgui.Col.ButtonActive])) or imgui.ColorConvertFloat4ToU32(imgui.ImVec4(imgui.GetStyle().Colors[imgui.Col.TextDisabled]))
    dl:AddRectFilled(p, imgui.ImVec2(p.x + width, p.y + height), imgui.ColorConvertFloat4ToU32(imgui.GetStyle().Colors[imgui.Col.FrameBg]), height * 0.5)
    dl:AddCircleFilled(imgui.ImVec2(p.x + radius + t * (width - radius * 2.0), p.y + radius), radius - 1.5, col_circle)
    return rBool
end